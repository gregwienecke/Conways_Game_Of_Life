<!DOCTYPE html>
<html>
<head>
	<title>Conway's Game Of Life</title>
</head>
<body>
	<table id="grid"></table>
	<br>
	<button id="next">Next Generation</button>

	<script>
		// Creates a DOM table grid
		function createGrid(){
			var num = 10;
			var grid = document.querySelector('#grid');
			for (var row = 0; row < num; row++){
				// Create a row
				var tr = document.createElement('tr');
				grid.appendChild(tr);

				// Add len boxes in tds to the row
				for (var col = 0; col < num; col++){


					var td = document.createElement('td');
					tr.appendChild(td);

					var box = document.createElement('input');
					box.setAttribute('type', 'checkbox');
					box.setAttribute('aliveneighbors', 0);
					// Randomly set checkboxes to true or false
					if (Math.random() > .5){
						box.setAttribute('checked', true);
					}
					td.appendChild(box);
				}
			}
		}
		createGrid();

		// Creates an array of arrays from the DOM table grid, each sub-array contains checkbox elements
		function buildArray(){
			var gridArray = [];

			var table = document.querySelector('table');
			// rows is an array of tr elements
			var rows = table.querySelectorAll('tr');

			for (var i = 0; i < rows.length; i++){
				var rowArray = [];
				// currentRow is a tr element
				var currentRow = rows[i];
				// currentRow is an array of td elements
				currentRow = currentRow.childNodes;
				//console.log(currentRow);
				currentRow.forEach(function(td){
					rowArray.push(td.childNodes[0]);
				});
				gridArray.push(rowArray);
			}
			return gridArray;
		}
		var gridArray = buildArray();




		function searchNeighbors(element, x, y){
			// console.log('row ' + x);
			// console.log('col ' + y);
			// console.log(element);

			var aliveneighbors = element.getAttribute('aliveneighbors');
			aliveneighbors = parseInt(aliveneighbors);
			var len = gridArray[0].length -1;

			//if top-left (x=0, y=0)
			if (x == 0 && y == 0){
				//console.log('test top left');
				//r
				if (gridArray[row][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}
				//b
				if (gridArray[row+1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//br
				if (gridArray[row+1][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

			//else if top-right (x=0, y=length-1)
			} else if (x == 0 && y == len){
				//console.log('test top right');
				//l
				if (gridArray[row][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}
				//bl
				if (gridArray[row+1][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//b
				if (gridArray[row+1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}				

			//else if bottom-left (x=0, y=length-1)
			} else if (x == len && y == 0){
				//console.log('test bottom left');
				// t
				if (gridArray[row-1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//tr
				if (gridArray[row-1][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}
				//r
				if (gridArray[row][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}	

			//else if bottom-right (x=length-1, y=length-1)
			} else if (x == len && y == len){
				//console.log('test bottom right');
				// tl
				if (gridArray[row-1][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				// t
				if (gridArray[row-1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}
				//l
				if (gridArray[row][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}	

			//else if bottom (x=length-1)
			} else if (x == len && y > 0 && y < len){
				//console.log('test bottom');
				// tl
				//console.log(gridArray[row][i].checked);
				if (gridArray[row-1][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				// t
				if (gridArray[row-1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//tr
				if (gridArray[row-1][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//l
				if (gridArray[row][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//r
				if (gridArray[row][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}			

			//else if top (x=0)
			} else if (x == 0){
				//console.log('test top');
				//l
				if (gridArray[row][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//r
				if (gridArray[row][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//bl
				if (gridArray[row+1][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//b
				if (gridArray[row+1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//br
				if (gridArray[row+1][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}				

			//else if left (y=0)
			} else if (y == 0 && x > 0 && x < len){
				//console.log('test left');
				// t
				if (gridArray[row-1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//tr
				if (gridArray[row-1][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}
				//r
				if (gridArray[row][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}
				//b
				if (gridArray[row+1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//br
				if (gridArray[row+1][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

			//else if right (y=length-1)
			} else if (y == len){
				//console.log('test right');
				// tl
				if (gridArray[row-1][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				// t
				if (gridArray[row-1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//l
				if (gridArray[row][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//bl
				if (gridArray[row+1][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//b
				if (gridArray[row+1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

			//else
			} else {
			// tl
				if (gridArray[row-1][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				// t
				if (gridArray[row-1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//tr
				if (gridArray[row-1][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//l
				if (gridArray[row][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//current
				// gridArray[row][i]

				//r
				if (gridArray[row][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//bl
				if (gridArray[row+1][i-1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//b
				if (gridArray[row+1][i].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}

				//br
				if (gridArray[row+1][i+1].checked){
					aliveneighbors = element.getAttribute('aliveneighbors');
					aliveneighbors = parseInt(aliveneighbors);
					element.setAttribute('aliveneighbors', aliveneighbors + 1);
				}
			}
		}



		//function loopThroughGrid(){
			// For each row in gridArray
			for (var row = 0; row < gridArray[0].length; row++){
				var currentRow = gridArray[row];
				//	console.log("Row " + row);

				// If first row
				if (row == 0){
					// for each box in the current row
					for (var i = 0; i < gridArray[0].length; i++){

						// If first row, first col
						if (i == 0){
							// Search r, br, b
							searchNeighbors(currentRow[i], row, i);
						// If first row, last col
						} else if (i == currentRow.length - 1){
							// Search l, bl, b
							searchNeighbors(currentRow[i], row, i);
						// First row, any other box
						} else {
							// Search l, bl, b, br, r
							searchNeighbors(currentRow[i], row, i);

						}

					}

				// If last row
				} else if (row == gridArray[0].length - 1){
					// for each box in the current row
					for (var i = 0; i < gridArray[0].length; i++){

						// If last row, first col
						if (i == 0){
							//Search t, tr, r
							searchNeighbors(currentRow[i], row, i);

						// If last row, last col
						} else if (i == currentRow.length - 1){
							// Search t, tl, l
							searchNeighbors(currentRow[i], row, i);

						// Last row, any other box
						} else {
							// Search l, tl, t, tr, r
							searchNeighbors(currentRow[i], row, i);
						}

					}

				// Any middle rows
				} else {
					// for each box in the current row
					for (var i = 0; i < gridArray[0].length; i++){

						// If first col
						if (i == 0){
							// Search t, tr, r, br, b
							searchNeighbors(currentRow[i], row, i);
						// If last col
						} else if (i == currentRow.length - 1){
							// Search t, tl, l, bl, b
							searchNeighbors(currentRow[i], row, i);
						// Any other box
						} else {
							// Search ALL neighbors
							searchNeighbors(currentRow[i], row, i);
						}

					} // end for col

				} // end if

			} // end for row

		//} // end function

		function turn(){
			var grid = buildArray();
			for (var row = 0; row < grid[0].length; row++){
				for (var col = 0; col < grid[0].length; col++){
					var neighbs = grid[row][col].getAttribute('aliveneighbors');
					// If it is a live cell
					if (grid[row][col].checked){
						if (parseInt(neighbs) < 2 || parseInt(neighbs) > 3){
							grid[row][col].checked = false;
						}

					// Else it is a dead cell
					} else {
						if (parseInt(neighbs) == 3){
							grid[row][col].checked = true;
						}
					}

				}
			}
		}
		//turn();

		document.querySelector('button').addEventListener('click', turn);

	</script>
</body>
</html>
